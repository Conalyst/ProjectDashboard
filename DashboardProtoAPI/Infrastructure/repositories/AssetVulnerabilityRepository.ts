import { BaseRepository } from "../contracts/BaseRepository"
// import  {CompanyAssetEntity as Asset}  from "../db/models/ComanyAsset"
// import {AssetEntity} from '../db/models/Asset'

import db from '../db/models'

export class AssetVulnerabilityRepository {
    constructor(){
         
    }

    public async GetByAssetId(AssetId: number){
      let vulnerabilities = await db.AssetVulnerability.findAll({
        where: {assetId: `${AssetId}`},
        include: [
          {
            model: db.Asset,
            attributes: ['id', 'title', 'description']
          }, 
          {
            model: db.Vulnerability,
            attributes: ['id', 'category','title', 'description']
          }
        ],
        attributes: ['id', 'assetId', 'vulnerabilityId']
        // include: { all: true, nested: true }
      })
        return vulnerabilities;      
    }   
    public async GetByVulnetabilityId(vulnerabilityId: number){
      let vulnerabilities = await db.AssetVulnerability.findAll({
        where: {vulnerabilityId: `${vulnerabilityId}`},
        include: [
                  {
                    model: db.Asset,
                    attributes: ['id', 'title', 'description']
                  }, 
                  {
                    model: db.Vulnerability,
                    attributes: ['id', 'category','title', 'description']
                  }
                ],
        attributes: ['id', 'assetId', 'vulnerabilityId']
        // include: { all: true, nested: true }
      })
        return vulnerabilities;      
    }   
    
}