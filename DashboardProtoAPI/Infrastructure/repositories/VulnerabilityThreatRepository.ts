import { BaseRepository } from "../contracts/BaseRepository"
// import  {CompanyAssetEntity as Asset}  from "../db/models/ComanyAsset"
// import {AssetEntity} from '../db/models/Asset'

import db from '../db/models'

export class VulnerabilityThreatRepository {
    constructor(){
         
    }

    public async GetByThreatId(ThreatId: number){
      let threats = await db.VulnerabilityThreat.findAll({
        where: {ThreatId: `${ThreatId}`},
        include: [
          {
            model: db.Threat,
            attributes: ['id', 'category', 'agent', 'title', 'description']
          }, 
          {
            model: db.Vulnerability,
            attributes: ['id','title', 'description']
          }
        ],
        attributes: ['id', 'threatId', 'vulnerabilityId']
        // include: { all: true, nested: true }
      })
        return threats;      
    }   
    
    public async GetByVulnetabilityId(vulnerabilityId: number){
      let vulnerabilities = await db.VulnerabilityThreat.findAll({
        where: {vulnerabilityId: `${vulnerabilityId}`},
        include: [
                  {
                    model: db.Threat,
                    attributes: ['id', 'category', 'agent', 'title', 'description']
                  }, 
                  {
                    model: db.Vulnerability,
                    attributes: ['id','title', 'description']
                  }
                ],
        attributes: ['id', 'threatId', 'vulnerabilityId']
        // include: { all: true, nested: true }
      })
        return vulnerabilities;      
    }   
    
}