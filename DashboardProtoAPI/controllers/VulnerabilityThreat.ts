import express from 'express'
import  {VulnerabilityThreatRepository as vulnerabilityThreat} from '../Infrastructure/repositories/VulnerabilityThreatRepository'

export class VulnerabilityThreatApi{
    private _vulnerabilityThreat:any;
    constructor(){
        this._vulnerabilityThreat = new vulnerabilityThreat();
    }

    async getThreatsByVulnerabilityId(req: express.Request, res: express.Response){
      let VulnerabilityId = req.params.id;
      // console.log(Vulnerability)
      let vulnerabilities = await this._vulnerabilityThreat.GetByVulnetabilityId(VulnerabilityId);
      return  res.status(200).json(vulnerabilities);
    };

    async getVulnerabilitiesByThreatId(req: express.Request, res: express.Response){
      let threatId = req.params.id;
      // console.log(Vulnerability)
      let threats = await this._vulnerabilityThreat.GetByThreatId(threatId);
      return  res.status(200).json(threats);
    };
}