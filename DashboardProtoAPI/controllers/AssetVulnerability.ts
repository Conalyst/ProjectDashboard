import express from 'express'
import  {AssetVulnerabilityRepository as assetVulnerability} from '../Infrastructure/repositories/AssetVulnerabilityRepository'

export class AssetVulnerabilityApi{
    private _AssetVulnerability:any;
    constructor(){
        this._AssetVulnerability = new assetVulnerability();
    }

    async getAssetsByVulnerabilityId(req: express.Request, res: express.Response){
      let VulnerabilityId = req.params.id;
      // console.log(Vulnerability)
      let vulnerabilities = await this._AssetVulnerability.GetByVulnetabilityId(VulnerabilityId);
      return  res.status(200).json(vulnerabilities);
    };

    async getVulnerabilitiesByAssetId(req: express.Request, res: express.Response){
      let assetId = req.params.id;
      // console.log(Vulnerability)
      let assets = await this._AssetVulnerability.GetByAssetId(assetId);
      return  res.status(200).json(assets);
    };
}