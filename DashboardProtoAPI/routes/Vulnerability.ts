import {Router, Request, Response} from 'express'
import { VulnerabilityApi } from '../controllers/Vulnerability'
const passport = require("passport");
const vulnerabilityApi = new VulnerabilityApi();

const vulnerabilityRouter = Router();


vulnerabilityRouter.get("/", (req, res) => {     
  vulnerabilityApi.getAllVulnerabilities(req, res);    
})

vulnerabilityRouter.get("/:id", (req, res) => {     
  vulnerabilityApi.getVulnerabilityById(req, res);    
})

vulnerabilityRouter.post("/" ,passport.authenticate("jwt", { session: false }), (req, res) =>{
    vulnerabilityApi.create(req, res)
  }
)

vulnerabilityRouter.put("/:id" ,passport.authenticate("jwt", { session: false }), (req, res) =>{
    vulnerabilityApi.update(req, res)
  }
)
vulnerabilityRouter.delete('/:id' ,passport.authenticate("jwt", { session: false }),
  (req, res) => vulnerabilityApi.delete(req, res)
)
export default vulnerabilityRouter;
