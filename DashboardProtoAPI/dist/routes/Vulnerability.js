"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const Vulnerability_1 = require("../controllers/Vulnerability");
const passport = require("passport");
const vulnerabilityApi = new Vulnerability_1.VulnerabilityApi();
const vulnerabilityRouter = (0, express_1.Router)();
vulnerabilityRouter.get("/", (req, res) => {
    vulnerabilityApi.getAllVulnerabilities(req, res);
});
vulnerabilityRouter.get("/:id", (req, res) => {
    vulnerabilityApi.getVulnerabilityById(req, res);
});
vulnerabilityRouter.post("/", (req, res) => {
    vulnerabilityApi.create(req, res);
});
vulnerabilityRouter.put("/:id", passport.authenticate("jwt", { session: false }), (req, res) => {
    vulnerabilityApi.update(req, res);
});
vulnerabilityRouter.delete('/:id', passport.authenticate("jwt", { session: false }), (req, res) => vulnerabilityApi.delete(req, res));
exports.default = vulnerabilityRouter;
